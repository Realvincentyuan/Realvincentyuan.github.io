<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Introduction to various Keras Callbacks</title>
    <link rel="stylesheet" href="../assets/built/screen.css%3Fv=9ec7b1b9f1.css">


    <style>
        :root {
            --background-color: #ffffff
        }
    </style>

    <script>
        /* The script for calculating the color contrast was taken from
        https://gomakethings.com/dynamically-changing-the-text-color-based-on-background-color-contrast-with-vanilla-js/ */
        var accentColor = getComputedStyle(document.documentElement).getPropertyValue('--background-color');
        accentColor = accentColor.trim().slice(1);
        var r = parseInt(accentColor.substr(0, 2), 16);
        var g = parseInt(accentColor.substr(2, 2), 16);
        var b = parseInt(accentColor.substr(4, 2), 16);
        var yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
        var textColor = (yiq >= 128) ? 'dark' : 'light';

        document.documentElement.className = `has-${textColor}-text`;
    </script>

    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Spacecraft">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Introduction to various Keras Callbacks">
    <meta property="og:description" content="1 Introduction

In tensorflow.keras, callbacks can run along with the model&#x27;s life cycle during fit, evaluate and predict processes. At present, tensorflow.keras has built many types of callbacks available for users to prevent overfitting, visualize the training process, debug, save model checkpoints, and generate TensorBoard, etc. Through this">
    <meta property="og:url" content="https://realvincentyuan.github.io/Spacecraft/introduction-to-various-keras-callbacks/">
    <meta property="og:image" content="https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000">
    <meta property="article:published_time" content="2021-10-02T05:00:00.000Z">
    <meta property="article:modified_time" content="2023-06-12T02:15:26.000Z">
    <meta property="article:tag" content="Tech">
    <meta property="article:tag" content="AI">
    <meta property="article:tag" content="Python">
    
    <meta property="article:publisher" content="https://www.facebook.com/ghost">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Introduction to various Keras Callbacks">
    <meta name="twitter:description" content="1 Introduction

In tensorflow.keras, callbacks can run along with the model&#x27;s life cycle during fit, evaluate and predict processes. At present, tensorflow.keras has built many types of callbacks available for users to prevent overfitting, visualize the training process, debug, save model checkpoints, and generate TensorBoard, etc. Through this">
    <meta name="twitter:url" content="https://realvincentyuan.github.io/Spacecraft/introduction-to-various-keras-callbacks/">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Vincent Yuan">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Tech, AI, Python">
    <meta name="twitter:site" content="@ghost">
    <meta property="og:image:width" content="2000">
    <meta property="og:image:height" content="1500">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Spacecraft",
        "url": "https://realvincentyuan.github.io/Spacecraft/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://realvincentyuan.github.io/Spacecraft/favicon.ico",
            "width": 48,
            "height": 48
        }
    },
    "author": {
        "@type": "Person",
        "name": "Vincent Yuan",
        "url": "https://realvincentyuan.github.io/Spacecraft/author/vincent/",
        "sameAs": []
    },
    "headline": "Introduction to various Keras Callbacks",
    "url": "https://realvincentyuan.github.io/Spacecraft/introduction-to-various-keras-callbacks/",
    "datePublished": "2021-10-02T05:00:00.000Z",
    "dateModified": "2023-06-12T02:15:26.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&ixlib=rb-4.0.3&q=80&w=2000",
        "width": 2000,
        "height": 1500
    },
    "keywords": "Tech, AI, Python",
    "description": "1 Introduction\n\nIn tensorflow.keras, callbacks can run along with the model&#x27;s life cycle during fit, evaluate and predict processes. At present, tensorflow.keras has built many types of callbacks available for users to prevent overfitting, visualize the training process, debug, save model checkpoints, and generate TensorBoard, etc. Through this article, we will learn how to use various callbacks in tensorflow.keras and how to customize callbacks.\n\n\n2 Using Callbacks\n\nUsing callbacks is very simp",
    "mainEntityOfPage": "https://realvincentyuan.github.io/Spacecraft/introduction-to-various-keras-callbacks/"
}
    </script>

    <meta name="generator" content="Ghost 5.49">
    <link rel="alternate" type="application/rss+xml" title="Spacecraft" href="../rss/index.html">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.33/umd/portal.min.js" data-i18n="false" data-ghost="https://realvincentyuan.github.io/Spacecraft/" data-key="206cb569cfe36163ae0b6ed398" data-api="https://realvincentyuan.github.io/Spacecraft/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="206cb569cfe36163ae0b6ed398" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://realvincentyuan.github.io/Spacecraft/" crossorigin="anonymous"></script>
    
    <link href="https://realvincentyuan.github.io/Spacecraft/webmentions/receive/" rel="webmention">
    <script defer src="../public/cards.min.js%3Fv=9ec7b1b9f1"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=9ec7b1b9f1.css">
    <script defer src="../public/member-attribution.min.js%3Fv=9ec7b1b9f1"></script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-633EG809GP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-633EG809GP');
</script>

<!-- Reading progress bar -->
<style>
.reading-progress {
  position: fixed;
  top: 0;
  z-index: 999;
  width: 100%;
  height: 5px; /* Progress bar height */
  background: #c5d2d9; /* Progress bar background color */
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; /* Hide default progress bar */
}

.reading-progress::-webkit-progress-bar {
  background-color: transparent;
}

.reading-progress::-webkit-progress-value {
  background: var(--ghost-accent-color); /* Progress bar color */
}
</style><style>:root {--ghost-accent-color: #FF1A75;}</style>
</head>

<body class="post-template tag-tech tag-ai tag-python is-head-left-logo has-classic-feed">
<div class="gh-site">

    <header id="gh-head" class="gh-head gh-outer">
        <div class="gh-head-inner gh-inner">
            <div class="gh-head-brand">
                <div class="gh-head-brand-wrapper">
                    <a class="gh-head-logo" href="../index.html">
                            Spacecraft
                    </a>
                </div>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.5 17.5L12.5 12.5L17.5 17.5ZM14.1667 8.33333C14.1667 9.09938 14.0158 9.85792 13.7226 10.5657C13.4295 11.2734 12.9998 11.9164 12.4581 12.4581C11.9164 12.9998 11.2734 13.4295 10.5657 13.7226C9.85792 14.0158 9.09938 14.1667 8.33333 14.1667C7.56729 14.1667 6.80875 14.0158 6.10101 13.7226C5.39328 13.4295 4.75022 12.9998 4.20854 12.4581C3.66687 11.9164 3.23719 11.2734 2.94404 10.5657C2.65088 9.85792 2.5 9.09938 2.5 8.33333C2.5 6.78624 3.11458 5.30251 4.20854 4.20854C5.30251 3.11458 6.78624 2.5 8.33333 2.5C9.88043 2.5 11.3642 3.11458 12.4581 4.20854C13.5521 5.30251 14.1667 6.78624 14.1667 8.33333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-tech"><a href="../tag/tech/index.html">Tech</a></li>
    <li class="nav-life"><a href="https://realvincentyuan.github.io/Spacecraft/tag/life/">Life</a></li>
    <li class="nav-about"><a href="../about/index.html">About</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.5 17.5L12.5 12.5L17.5 17.5ZM14.1667 8.33333C14.1667 9.09938 14.0158 9.85792 13.7226 10.5657C13.4295 11.2734 12.9998 11.9164 12.4581 12.4581C11.9164 12.9998 11.2734 13.4295 10.5657 13.7226C9.85792 14.0158 9.09938 14.1667 8.33333 14.1667C7.56729 14.1667 6.80875 14.0158 6.10101 13.7226C5.39328 13.4295 4.75022 12.9998 4.20854 12.4581C3.66687 11.9164 3.23719 11.2734 2.94404 10.5657C2.65088 9.85792 2.5 9.09938 2.5 8.33333C2.5 6.78624 3.11458 5.30251 4.20854 4.20854C5.30251 3.11458 6.78624 2.5 8.33333 2.5C9.88043 2.5 11.3642 3.11458 12.4581 4.20854C13.5521 5.30251 14.1667 6.78624 14.1667 8.33333Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="index.html#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-btn gh-btn gh-primary-btn" href="index.html#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    
<progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress>



<main class="gh-main gh-outer">
    <div class="gh-inner">
            <article class="gh-article post tag-tech tag-ai tag-python">
                    <header class="gh-article-header gh-canvas">
                        <h1 class="gh-article-title">Introduction to various Keras Callbacks</h1>
                            <figure class="gh-article-image has-caption">
        <img
            srcset="https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;300 300w,
                    https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;720 720w,
                    https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;960 960w,
                    https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1200 1200w,
                    https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000 2000w,
                    https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000"
            sizes="(max-width: 1200px) 100vw, 1200px"
            src="https://images.unsplash.com/photo-1573141597928-403fcee0e056?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;M3wxMTc3M3wwfDF8c2VhcmNofDZ8fGdvb2dsZXxlbnwwfHx8fDE2ODY1MzYwODd8MA&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1200"
            alt="Introduction to various Keras Callbacks"
        >
            <figcaption>Photo by <a href="https://unsplash.com/ko/@kai_wenzel?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit">Kai Wenzel</a> / <a href="https://unsplash.com/?utm_source=ghost&utm_medium=referral&utm_campaign=api-credit">Unsplash</a></figcaption>
    </figure>
                    </header>

                <section class="gh-content gh-canvas">
                    <h2 id="1-introduction">1 Introduction</h2><p>In tensorflow.keras, callbacks can run along with the model's life cycle during <code>fit</code>, <code>evaluate</code> and <code>predict</code> processes. At present, tensorflow.keras has built many types of callbacks available for users to prevent overfitting, visualize the training process, debug, save model checkpoints, and generate TensorBoard, etc. Through this article, we will learn how to use various callbacks in tensorflow.keras and how to customize callbacks.</p><h2 id="2-using-callbacks">2 Using Callbacks</h2><p>Using callbacks is very simple. First, define the callbacks, then pass the defined callbacks to the <code>callbacks</code> parameter in <code>model.fit()</code>, <code>model.evaluate()</code>, and <code>model.predict()</code>.</p><p>Take the most common <code>ModelCheckpoint</code> as an example. The usage process is as follows:</p><pre><code class="language-python">...
model_checkpoint_callback = tf.keras.callbacks.ModelCheckpoint(
    filepath=filePath,
    save_weights_only=True,
    monitor='val_accuracy',
    mode='max')

model.fit(x, y, callbacks=model_checkpoint_callback)
</code></pre><p>In this way, when the model is trained, the model checkpoints will be stored in the corresponding position for later use. In addition to ModelCheckpoint, there are many other types of callbacks available for use in TensorFlow 2.0. Let's explore them.</p><h3 id="21-earlystopping">2.1 EarlyStopping</h3><p>This callback can monitor the specified evaluation metric. During the training process, when the evaluation metric stops increasing, the training will end early to prevent overfitting. Its default parameters are as follows:</p><pre><code class="language-python">tf.keras.callbacks.EarlyStopping(monitor='val_loss',
        min_delta=0,
        patience=0,
        verbose=0,
        mode='auto',
        baseline=None,
        restore_best_weights=False)
</code></pre><p>The parameters are as follows:</p><ul><li>monitor: the evaluation metric monitored by callbacks.</li><li>min_delta: the smallest metric improvement that will be counted.</li><li>patience: the number of epochs to wait before stopping training when the evaluation metric stops improving.</li><li>verbose: whether to print logs.</li><li>mode: the mode of monitoring metrics, such as whether to monitor if the metric is decreasing, increasing, or automatically inferred based on the metric name.</li><li>baseline: the baseline of the monitored metric. When the result of the model training is below the standard line, the training will stop.</li><li>restore_best_weights: whether to restore the model from the epoch with the best training effect. If set to False, the model weights will be restored from the last step.</li></ul><h3 id="22-learningratescheduler">2.2 LearningRateScheduler</h3><p>This callback can adjust the learning rate during the model training process. Generally, the learning rate can be appropriately reduced as the number of training increases to help the model converge to the global optimum. Therefore, this callback needs to be used together with a learning rate scheduler. At the beginning of each epoch, the schedule function will obtain the latest learning rate and use it in the current epoch:</p><pre><code class="language-python">tf.keras.callbacks.LearningRateScheduler(
    schedule, verbose=0
)

# The scheduling function calls the initial learning rate before 10 epochs, and then the learning rate decreases exponentially
def scheduler(epoch, lr):
  if epoch &lt; 10:
    return lr
  else:
    return lr * tf.math.exp(-0.1)

model = tf.keras.models.Sequential([tf.keras.layers.Dense(10)])
model.compile(tf.keras.optimizers.SGD(), loss='mse')
callback = tf.keras.callbacks.LearningRateScheduler(scheduler)
history = model.fit(np.arange(100).reshape(5, 20), np.zeros(5),
                    epochs=15, callbacks=[callback], verbose=0)

</code></pre><h3 id="23-reducelronplateau">2.3 ReduceLROnPlateau</h3><p>Compared with LearningRateScheduler, ReduceLROnPlateau does not adjust the learning rate according to the pre-set schedule. It reduces the learning rate when the evaluation metric stops improving.</p><pre><code class="language-python">tf.keras.callbacks.ReduceLROnPlateau(
    monitor='val_loss', factor=0.1, patience=10, verbose=0,
    mode='auto', min_delta=0.0001, cooldown=0, min_lr=0, **kwargs
)
</code></pre><p>Important parameters are:</p><ul><li>factor: the degree of learning rate reduction, new_lr = lr * factor.</li><li>cooldown: the number of epochs to wait before monitoring the evaluation metric again.</li><li>min_lr: the minimum allowed learning rate.</li></ul><h3 id="24-tensorboard">2.4 TensorBoard</h3><p>TensorBoard can conveniently display the model architecture and the training process. This callback can generate TensorBoard logs, and you can view the visualization results in TensorBoard after the training is completed.</p><pre><code class="language-python">tf.keras.callbacks.TensorBoard(
    log_dir='logs', histogram_freq=0, write_graph=True,
    write_images=False, write_steps_per_second=False, update_freq='epoch',
    profile_batch=2, embeddings_freq=0, embeddings_metadata=None, **kwargs
)
</code></pre><p>Important parameters are:</p><ul><li>log_dir: the path to the log output.</li><li>histogram_freq: the frequency of calculating the activation function and weight histograms. If set to 0, the histograms will not be calculated.</li><li>write_graph: whether to visualize the graph in TensorBoard.</li><li>update_freq: a string that can be 'batch', 'epoch', or an integer. Loss and evaluation metrics will be written to TensorBoard after the specified processing completes. If set to an integer, it means that the loss and evaluation metrics will be written to TensorBoard after the specified number of samples have been trained.</li><li>write_images: whether to write weight histograms and other variables as images.</li><li>write_steps_per_second: whether to write the number of steps per second during processing.</li><li>profile_batch: the batch for profiling. The default value is 2, and -1 means that all batches will be profiled.</li></ul><h3 id="25-csvlogger">2.5 CSVLogger</h3><p>As the name suggests, this callback can write the training process to a CSV file.</p><pre><code class="language-python">tf.keras.callbacks.CSVLogger(
    filename, separator=',', append=False
)
</code></pre><p>Important parameters:</p><ul><li>append: whether to continue writing logs to existing files.</li></ul><h3 id="26-terminateonnan">2.6 TerminateOnNaN</h3><p>Stop training when the loss becomes NaN.</p><pre><code class="language-python">tf.keras.callbacks.TerminateOnNaN()
</code></pre><h3 id="27-custom-callback">2.7 Custom Callback</h3><p>In addition to the above callbacks, there are other callbacks available on the <a>TensorFlow official website</a>. When using multiple callbacks, you can pass multiple callbacks into a list, or use <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/CallbackList?ref=localhost">tf.keras.callbacks.CallbackList</a>. In addition, you can also customize callbacks, which requires inheriting <code>keras.callbacks.Callback</code> and then overriding methods at different training stages.</p><pre><code class="language-python">training_finished = False

class MyCallback(tf.keras.callbacks.Callback):
  def on_train_end(self, logs=None):
    global training_finished
    training_finished = True

model = tf.keras.Sequential([tf.keras.layers.Dense(1, input_shape=(1,))])
model.compile(loss='mean_squared_error')
model.fit(tf.constant([[1.0]]), tf.constant([[1.0]]),
          callbacks=[MyCallback()])

assert training_finished == True
</code></pre><h2 id="3-conclusion">3 Conclusion</h2><p>This article summarizes some commonly used tf.keras.callbacks. In actual work, please use them as needed and check the official documentation of tf.keras.callbacks to confirm the parameter values.</p><p>Hope this sharing is helpful to you, and welcome to leave a comment in the comment section to discuss!</p>
                    <aside class="gh-article-meta">
                        <div class="gh-article-meta-inner">
                                <div class="gh-article-meta-wrapper">
                                <h4 class="gh-author-name">
                                    <a href="../author/vincent/index.html">Vincent Yuan</a>
                                </h4>
                            <time class="gh-article-date" datetime="2021-10-02">Oct 2, 2021</time></div>
                            


                             <a class="gh-article-tag" href="../tag/tech/index.html" style="--tag-color: ">Tech</a>
                             <a class="gh-article-tag" href="../tag/ai/index.html" style="--tag-color: ">AI</a>
                             <a class="gh-article-tag" href="../tag/python/index.html" style="--tag-color: ">Python</a>
                           

                        </div>
                    </aside>
                </section>


                <footer class="gh-article-footer gh-canvas">
                    <nav class="gh-navigation">
                        <div class="gh-navigation-previous">
                                <a class="gh-navigation-link" href="../tips-for-common-operations-on-python-dictionaries-co/index.html">← Previous</a>
                        </div>

                        <div class="gh-navigation-middle"></div>

                        <div class="gh-navigation-next">
                                <a class="gh-navigation-link" href="../customizing-models-with-tf-keras/index.html">Next →</a>
                        </div>
                    </nav>
                </footer>
            </article>
    </div>
</main>

    <footer class="gh-foot gh-outer">
        <div class="gh-foot-inner gh-inner">
            <nav class="gh-foot-menu">
                <ul class="nav">
    <li class="nav-sign-up"><a href="index.html#/portal/">Sign up</a></li>
</ul>

            </nav>

            <div class="gh-copyright">
                    Spacecraft © 2023. Powered by <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a>
            </div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/built/main.min.js%3Fv=9ec7b1b9f1"></script>

  <script>
    const progressBar = document.querySelector('.reading-progress');

    function updateProgress() {
      const totalHeight = document.body.clientHeight;
      const windowHeight = document.documentElement.clientHeight;
      const position = window.scrollY;
      const progress = position / (totalHeight - windowHeight) * 100;
      progressBar.setAttribute('value', progress);
      requestAnimationFrame(updateProgress);
    }

    requestAnimationFrame(updateProgress);
  </script>




</body>

</html>
